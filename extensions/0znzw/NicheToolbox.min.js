/**!
 * Niche Toolbox
 * @author 0znzw <meow@miyo.icu> (@link https://scratch.mit.edu/users/0znzw/)
 * @version 2.6
 * @license MIT AND LGPL-3.0
 * Do not remove this comment
 */
(function(Scratch){"use strict";if(!Scratch.extensions.unsandboxed)throw new Error('"Niche-Toolbox" extension must be ran unsandboxed.');const BlockType=Scratch.BlockType,ArgumentType=Scratch.ArgumentType,Cast=Scratch.Cast,vm=Scratch.vm,renderer=vm.renderer,runtime=vm.runtime,Runtime=runtime.constructor;function throwwww(e){throw new Error(e)}const menuIconURI="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIyNjciIGhlaWdodD0iMjY3IiB2aWV3Qm94PSIwLDAsMjY3LDI2NyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEwNi41LC00Ni41KSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0xMDYuNSwxODBjMCwtNzMuNzMwMDEgNTkuNzY5OTksLTEzMy41IDEzMy41LC0xMzMuNWM3My43MzAwMSwwIDEzMy41LDU5Ljc2OTk5IDEzMy41LDEzMy41YzAsNzMuNzMwMDEgLTU5Ljc2OTk5LDEzMy41IC0xMzMuNSwxMzMuNWMtNzMuNzMwMDEsMCAtMTMzLjUsLTU5Ljc2OTk5IC0xMzMuNSwtMTMzLjV6IiBmaWxsPSIjZWQ2MzAwIiBzdHJva2Utd2lkdGg9IjAiLz48cGF0aCBkPSJNMjUzLjk3MTczLDEwMS4yMTI4NWMwLjQ5OTE0LDAuMDY1MTggMS4zMDU0NiwwLjE5NTUyIDEuNzkxODEsMC4yNzM3M2M3LjEyODgzLDEuMTA3OTYgMTMuNDEyOTUsMy45NDk1NyAxOS4wNDQzNSw4LjY0MjEyYzEuODU1OCwxLjUyNTA4IDMuMzUzMjQsMy4wNjMyIDE2LjgwNDU5LDE3LjA4ODczYzYuNjgwODcsNi45NzM2NiA3LjgxOTk2LDguMjkwMTggOS44OTMzMywxMS40MDU1MmMxLjQzMzQ1LDIuMTUwNzYgMi4wNDc3OCwzLjMxMDg2IDMuNDU1NjMsNi41MDQ0MWMwLjY3ODMzLDEuNTUxMTUgMS41NDg2NCwzLjM0OTk2IDEuOTE5OCwzLjk4ODY3YzAuNzAzOTMsMS4xODYxOCAyLjQwNjE0LDMuNTU4NTIgMy4zMDIwNSw0LjYxNDM1bDAuNDk5MTQsMC41NzM1M2wwLjY5MTEzLC0wLjM2NDk4YzEuMDExMDksLTAuNTIxMzkgMS44MzAyLC0wLjcxNjkzIDMuMDg0NDYsLTAuNzE2OTNjMS45OTY1OCwwIDMuNjk4OCwwLjc4MjEgNS4yMjE4NCwyLjQxMTQ2YzEuMzgyMjUsMS40ODU5NyAyLjAzNDk4LDIuOTE5ODEgMi4xNTAxNyw0Ljc1NzczYzAuMDg5NTksMS4zNDI1OSAtMC4wODk1OSwyLjMwNzE3IC0wLjYyNzEzLDMuNDE1MTRjLTAuMzQ1NTcsMC43MTY5MiAtMS4xNjQ2NywxLjYwMzMgLTYuNDI0OSw2Ljk4NjY5Yy0zLjMxNDg0LDMuMzg5MDYgLTYuMjk2OTMsNi4zNzQwNSAtNi42Mjk2OSw2LjYyMTcxYy0xLjg2ODU5LDEuNDA3NzYgLTQuNDUzOTIsMS42MDMyOSAtNi43MzIwNywwLjUwODM2Yy0yLjcwMDUxLC0xLjMwMzQ4IC00LjM4OTkzLC0zLjc0MTAxIC00LjU5NDcsLTYuNjQ3NzljLTAuMTQwNzgsLTIuMDU5NTEgMC40NzM1NSwtMy41NDU0OSAyLjIxNDE3LC01LjM5NjQ0bDEuMTc3NDcsLTEuMjI1MjhsLTEuODE3NCwtMi4yOTQxNGMtNC4xMjExNSwtNS4yNDAwMiAtNi4yNDU3MywtNi44NDMzMSAtOS4yOTE4LC03LjAxMjc3Yy0wLjc0MjMyLC0wLjA1MjE0IC0xLjM5NTA0LDAgLTIuMDQ3NzgsMC4xNDMzOWMtMy41MzI0MiwwLjc5NTEyIC01LjkwMDE2LDAuNTczNTMgLTguMTc4MzIsLTAuNzE2OTNjLTAuODA2MzEsLTAuNDY5MjYgLTEuODQzLC0xLjE4NjE3IC0yLjMxNjU1LC0xLjYyOTM2bC0wLjMzMjc3LC0wLjI5OThsLTEzLjQxMjk1LDEzLjY2MDU1Yy03LjkwOTU1LDguMDU1NTUgLTEzLjM4NzM2LDEzLjcyNTcyIC0xMy4zMzYxNywxMy44MTY5N2MwLjA1MTE5LDAuMDc4MjEgMS4zOTUwNSwxLjM4MTcgMi45OTQ4OCwyLjkwNjc3YzEuNTk5ODMsMS41MjUwOCAzLjE2MTI2LDMuMDM3MTMgMy40ODEyMywzLjM2M2MwLjMxOTk3LDAuMzI1ODcgMi4wOTg5NywyLjA1OTUxIDMuOTY3NTcsMy44NDUyOWMxLjg2ODU5LDEuNzk4ODEgMy45OTMxNywzLjg0NTI5IDQuNzM1NDksNC41NjIyMWMwLjc0MjMyLDAuNzE2OTIgMi44NDEyOSwyLjczNzMzIDQuNjcxNSw0LjQ5NzA0YzEuODMwMiwxLjc1OTcxIDMuOTI5MTcsMy43ODAxMSA0LjY3MTQ5LDQuNDk3MDNjMC43NDIzMiwwLjcxNjkyIDIuODQxMjksMi43MzczMyA0LjY3MTUsNC40OTcwNGMxLjgzMDIsMS43NTk3MSAzLjkyOTE4LDMuNzgwMTEgNC42NzE1LDQuNDk3MDNjMC43NDIzMiwwLjcxNjkyIDIuODY2ODksMi43NzY0NCA0LjczNTQ5LDQuNTYyMjFjMS44Njg1OSwxLjc4NTc4IDMuOTY3NTcsMy44MDYxOCA0LjY3MTUsNC40OTcwM2MwLjcwMzkzLDAuNjkwODUgMS44MDQ2MSwxLjc0NjY3IDIuNDMxNzQsMi4zNDYyOGM3LjMyMDgxLDcuMDI1OCAxMi43MjE4MiwxMi4yNzg4NSAxMy40NTEzNCwxMy4wODcwMWMyLjQ1NzMzLDIuNjk4MjEgMy41NDUyMiw2LjQxMzE2IDIuOTQzNjksOS45MzI1N2MtMC44NzAzLDUuMDMxNDYgLTQuNDc5NTIsOS4zODUxMSAtOS4wOTk4MiwxMC45NzUzN2MtMS41NDg2NCwwLjUyMTM5IC0yLjA0Nzc4LDAuNjEyNjMgLTMuNzc1NTksMC42MTI2M2MtMi4wMDkzOCwwIC0yLjkwNTI4LC0wLjE2OTQ1IC00LjU4MTksLTAuODYwM2MtMS44NDMsLTAuNzU2MDIgLTMuMjM4MDUsLTEuNzMzNjQgLTUuMDA0MjYsLTMuNDgwMzFjLTAuNTYzMTQsLTAuNTQ3NDcgLTQuMTQ2NzUsLTQuNDA1NzggLTcuOTczNTQsLTguNTYzOTFjLTMuODEzOTgsLTQuMTU4MTMgLTcuODcxMTUsLTguNTUwODggLTguOTk3NDMsLTkuNzc2MTVjLTMuMzc4ODMsLTMuNjQ5NzcgLTE3LjU3MjUsLTE5LjA0Mzk1IC0yMC45ODk3MywtMjIuNzQ1ODZjLTEuNzUzNDEsLTEuOTAzMDkgLTQuMDQ0MzYsLTQuMzkyNzUgLTUuMTA2NjUsLTUuNTM5ODJjLTEuMDYyMjksLTEuMTQ3MDcgLTMuMTg2ODUsLTMuNDU0MjUgLTQuNzIyNjksLTUuMTIyNzFjLTEuNTM1ODQsLTEuNjU1NDMgLTIuODQxMjksLTMuMDI0MSAtMi45MDUyOCwtMy4wMjQxYy0wLjA1MTE5LDAgLTAuMzQ1NTcsMC4yNzM3NCAtMC42NTI3MywwLjYxMjY0Yy0wLjUzNzU1LDAuNjEyNjQgLTMuMTk5NjYsMy40NjcyOCAtMTAuOTk0MDEsMTEuODM1NjdjLTIuMDczMzcsMi4yMjg5NiAtNS4yNzMwMyw1LjY1NzE0IC03LjExNjAzLDcuNjI1NGMtMjYuNzQ5MTEsMjguNzE1ODMgLTMyLjEzNzMzLDM0LjQ3NzI1IC0zMi42NDkyNywzNC45NDY1Yy0xLjI2NzA3LDEuMTYwMSAtMi42NjIxMiwxLjcwNzU3IC00LjM4OTkzLDEuNzA3NTdjLTEuMzY5NDUsMC4wMTMwNCAtMi4wMjIxOCwtMC4xMTczMSAtMy40ODEyMiwtMC42OTA4NWMtMi4wNjA1OCwtMC44MDgxNyAtMi43MjYxMSwtMS4zOTQ3MyAtOS40NTgxOCwtOC4yOTAxOGMtNi44MzQ0NywtNi45ODY2OSAtNy4yNDQwMiwtNy40ODIwMiAtNy45MDk1NSwtOS41NDE1M2MtMC41ODg3NCwtMS44MjQ4OCAtMC4yMDQ3OCwtMy43MTQ5NCAxLjEyNjI4LC01LjUxMzc1YzAuMjU1OTcsLTAuMzUxOTQgMi45NDM2OSwtMy4wNjMyMSA1Ljk2NDE2LC02LjAwOTA4YzMuMDMzMjcsLTIuOTU4OTIgNi4zMzUzMiwtNi4xOTE1NyA3LjM1OTIxLC03LjE5NTI1YzEuOTcwOTksLTEuOTQyMiA1LjMxMTQzLC01LjIwMDkxIDEyLjY3MDYzLC0xMi4zODMxM2MyLjQ5NTczLC0yLjQzNzUyIDUuMzQ5ODMsLTUuMjI2OTggNi4zMzUzMiwtNi4xOTE1N2MwLjk4NTQ5LC0wLjk2NDU4IDMuODEzOTksLTMuNzI3OTcgNi4yNzEzMiwtNi4xMjY0YzIuNDcwMTMsLTIuMzk4NDIgNS4yODU4MywtNS4xNjE4MiA2LjI3MTMyLC02LjEyNjM5YzAuOTg1NDksLTAuOTc3NjIgMy43NjI3OSwtMy42ODg4NyA2LjE4MTczLC02LjA0ODE4YzIuNDA2MTQsLTIuMzU5MzEgNC4zNzcxMywtNC4zMjc1OCA0LjM3NzEzLC00LjM5Mjc1YzAsLTAuMTE3MzIgLTEuMTc3NDgsLTEuNDA3NzYgLTguOTU5MDMsLTkuODI4MjljLTEuNTIzMDQsLTEuNjU1NDMgLTMuNTA2ODIsLTMuODA2MTggLTQuNDE1NTMsLTQuNzk2ODRjLTAuODk1OTEsLTAuOTc3NjIgLTEuNjYzODIsLTEuNzg1NzggLTEuNjg5NDIsLTEuNzg1NzhjLTAuMDI1NiwwIC0wLjQ2MDc0LDAuMDkxMjQgLTAuOTcyNjksMC4xODI0OWMtMC41MTE5NCwwLjEwNDI4IC0xLjg2ODYxLDAuMzc4MDIgLTMuMDMzMjgsMC41OTk2MWMtMS4xNjQ2OCwwLjIyMTU5IC0yLjM2Nzc0LDAuNDU2MjIgLTIuNjg3NzEsMC41MjEzOWMtMC4zMTk5NywwLjA2NTE4IC0xLjUyMzA0LDAuMjk5OCAtMi42ODc3MSwwLjUyMTM5Yy0xLjE2NDY4LDAuMjIxNTkgLTIuMzY3NzQsMC40NTYyMiAtMi42ODc3MSwwLjUyMTRjLTAuMzE5OTcsMC4wNjUxOCAtMS41MjMwNCwwLjI5OTggLTIuNjg3NzEsMC41MjEzOWMtMS4xNjQ2OCwwLjIyMTU5IC0yLjUwODUzLDAuNDgyMjkgLTMuMDA3NjcsMC41ODY1N2MtNC4zMTMxNCwwLjg2MDMgLTYuNjI5NjksMS4yNTEzNSAtNi43MDY0OCwxLjE2MDFjLTAuMDUxMTksLTAuMDY1MTggLTIuMTM3MzYsLTMuMTE1MzQgLTQuNjIwMywtNi43NjUxYy0yLjQ5NTczLC0zLjY2MjggLTYuMTY4OTMsLTguOTk0MDYgLTguMTY1NTEsLTExLjg2MTczYy0yLjAwOTM4LC0yLjg2NzY3IC00LjYwNzUsLTYuNTgyNjIgLTUuNzcyMTgsLTguMjY0MTFjLTEuMTY0NjgsLTEuNjY4NDYgLTIuMTExNzgsLTMuMTQxNDEgLTIuMDg2MTcsLTMuMjU4NzFjMC4wMjU2LC0wLjExNzMyIDEuODY4NiwtMi4wNzI1NSA0LjA5NTU2LC00LjM1MzY1bDQuMDU3MTYsLTQuMTMyMDZsOS4wMjMwMiw5LjE4OTU5bDkuMDIzMDMsOS4xODk1OWw2LjA5MjE0LC0xLjc3Mjc0bDYuMTA0OTQsLTEuNzcyNzRsMS4xMTM0OCwtNC4wMDE3MWMwLjYyNzEzLC0yLjE4OTg2IDEuMTc3NDgsLTQuMTg0MiAxLjI0MTQ3LC00LjQxODgzYzAuMTAyMzksLTAuNDA0MDkgMC4yMzAzOCwtMC44ODYzNyAwLjQ3MzU1LC0xLjc1OTcxYzAuMTc5MTgsLTAuNTg2NTcgMC4zOTY3NiwtMS4zODE3IDAuNTExOTQsLTEuODUwOTVjMC4xMDIzOSwtMC4zNzgwMSAtMC4xMDIzOSwtMC42MTI2MyAtOC44OTUwNCwtOS41ODA2M2wtOS4wMTAyMywtOS4xODk1OWw0LjQ1MzkyLC00LjUzNjE0bDQuNDQxMTIsLTQuNTIzMWwxLjIxNTg3LDAuODIxMmMxLjU2MTQzLDEuMDY4ODYgMTguNTgzNiwxMi4zNTcwNiAyNC43NjUzMywxNi40MjM5NGMyLjYxMDkyLDEuNzA3NTcgNC43MjI2OSwzLjE4MDUxIDQuNzIyNjksMy4yNTg3MmMtMC4wMTI4LDAuMDkxMjUgLTAuMjA0NzgsMC45NTE1NCAtMC40MjIzNSwxLjkxNjEyYy0wLjY3ODMzLDMuMDM3MTMgLTEuNDQ2MjUsNi40MzkyMyAtMS41NDg2NCw2LjkwODQ5Yy0wLjA1MTE5LDAuMjQ3NjYgLTAuMzk2NzUsMS43OTg4MSAtMC43Njc5MSwzLjQ1NDI0Yy0wLjcyOTUyLDMuMjMyNjUgLTAuODA2MzEsMy42MTA2NiAtMC45OTgzLDQuNDk3MDNjLTAuMDYzOTksMC4zMjU4NyAtMC40MjIzNSwxLjkyOTE2IC0wLjc5MzUyLDMuNTg0NTljLTAuOTM0Myw0LjE5NzIzIC0wLjkyMTUsNC4xNDUwOSAtMC45NDcxLDQuNDMxODZjLTAuMDEyOCwwLjI3MzczIDAuNDQ3OTUsMC43NDI5OCA2LjI1ODUyLDYuMzIxOTFjMS44MzAyLDEuNzU5NzEgMy45MjkxOCwzLjc4MDExIDQuNjcxNSw0LjQ5NzAzYzEuMjAzMDcsMS4xNzMxMyA2Ljk2MjQ1LDYuNzEyOTYgOC44Njk0NCw4LjUyNDgxbDAuNzQyMzIsMC43MTY5MmwxMy41NzkzNCwtMTMuODMwMDFsMTMuNTc5MzQsLTEzLjgzbC0wLjI4MTU3LC0wLjQwNDA5Yy0wLjcwMzkzLC0xLjAwMzY5IC0xLjEyNjI4LC0yLjQzNzUyIC0xLjI0MTQ3LC00LjE4NDJjLTAuMTAyMzksLTEuNTY0MTggMC4wNjM5OSwtMi40NjM1OSAwLjcxNjczLC0zLjkxMDQ2YzAuOTg1NDksLTIuMTYzNzkgMS4yNTQyNywtMy43Mjc5OCAxLjAyMzg5LC01Ljg1MjY2Yy0wLjU3NTk0LC01LjA5NjYzIC00LjEwODM2LC0xMC4xMTUwNiAtMTAuMzkyNDgsLTE0LjcyOTQxYy0zLjM3ODgzLC0yLjQ3NjYzIC04LjEyNzEyLC00LjgzNTk0IC0xMi4xOTcwOCwtNi4wNjEyMmMtMy44OTQxMywtMS4xNjAyIC0wLjcwMzkzLC0zLjg3MTM2IDMuNzc1NTksLTQuMTcxMTZjMS4zNDM4NSwtMC4wOTEyNSA3Ljg3MTE1LDAuMDM5MSA4Ljc2NzA2LDAuMTgyNDl6IiBmaWxsPSIjZmZmZmZmIiBzdHJva2Utd2lkdGg9IjEiLz48L2c+PC9nPjwvc3ZnPjwhLS1yb3RhdGlvbkNlbnRlcjoxMzMuNToxMzMuNS0tPg==";let CustomLayers=[];(function(){var _0x319f41=_0x39b7;function _0x39b7(e,t){var M=_0x1014();return(_0x39b7=function(e,t){return M[e-=295]})(e,t)}function _0x1014(){var _0x1a7a35=["5111996tLmxub","1249FFuKyO","1978IqbbSd","6399coVOVY","runtime","36513147tcIYMv","2770QcbBHr","4226184ZCmoYg","56AWrHSS","getPrimitives","ext_scratch3_motion","1735195CoynVD","12TuUzZH","J05pY2hlLVRvb2xib3ggbXVzdCBiZSBydW4gdW5zYW5kYm94ZWRcbkFsc28gaWYgeW91IGFyZSBvbiBQTSBwbGVhc2UgdXNlIFRXLiBodHRwczovL3R1cmJvd2FycC5vcmcvZWRpdG9yJw==","649306AxaDMi",eval(atob("J21vdGlvbl9tb3ZlYmFja3N0ZXBzJw=="))];return _0x1014=function(){return _0x1a7a35},_0x1014()}!function(e,t){for(var M=_0x39b7,r=_0x1014();;)try{if(721474==parseInt(M(300))/1*(parseInt(M(301))/2)+-parseInt(M(306))/3+-parseInt(M(299))/4+parseInt(M(310))/5*(-parseInt(M(295))/6)+parseInt(M(297))/7*(-parseInt(M(307))/8)+-parseInt(M(302))/9*(-parseInt(M(305))/10)+parseInt(M(304))/11)break;r.push(r.shift())}catch(e){r.push(r.shift())}}(),vm[_0x319f41(303)][_0x319f41(309)][_0x319f41(308)]().hasOwnProperty(_0x319f41(298))&&throwwww(eval(atob(_0x319f41(296))))})();const hasOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function updateLayerOrder(){renderer.setLayerGroupOrdering(renderer.StageLayering.LAYER_GROUPS)}renderer.StageLayering=class{static get BACKGROUND_LAYER(){return"background"}static get VIDEO_LAYER(){return"video"}static get PEN_LAYER(){return"pen"}static get SPRITE_LAYER(){return"sprite"}static get LAYER_GROUPS(){return CustomLayers.length>0?CustomLayers:[this.BACKGROUND_LAYER,this.VIDEO_LAYER,this.PEN_LAYER,this.SPRITE_LAYER]}},renderer.attachRenderer=e=>{e.setLayerGroupOrdering(e.StageLayering.LAYER_GROUPS),e.offscreenTouching=!runtime.runtimeOptions.fencing,runtime.updatePrivacy()};let PROJECT_CHANGED=!1,ON_PROJECT_CHANGED=function(){vm.off("PROJECT_CHANGED",ON_PROJECT_CHANGED),PROJECT_CHANGED=!0};function cloneBlock(e,t){let M=[],r=t.blocks.getBlock(e);return null==(T=r)||null==T?[]:(M=[r],Object.values(r.inputs).forEach(e=>{e.name.startsWith("SUBSTACK")&&(M=[...M,...cloneStack(e.block,t)]),hasOwn(e,"shadow")&&e.block===e.shadow?M=[...M,...cloneBlock(e.block,t)]:(hasOwn(e,"shadow")&&(M=[...M,...cloneBlock(e.shadow,t)]),hasOwn(e,"block")&&(M=[...M,...cloneBlock(e.block,t)]))}),Object.values(r.fields).forEach(e=>{hasOwn(e,"id")&&(M=[...M,...cloneBlock(e.id,t)])}),M);var T}function cloneStack(e,t){let M=[],r=t.blocks.getBlock(e);if(null==(T=r)||null==T)return[];var T;if(M=cloneBlock(r.id,t),r.next)for(;r.next;)r.next&&(r=t.blocks.getBlock(r.next)),M=[...M,...cloneBlock(r.id,t)];return M}function stackToTarget(e,t,M){const r=[];if(M=Boolean(M??!1),!e?.[0])return-1;for(let T=0;T<e.length;T++)t.blocks.createBlock(e[T]),M&&r.push(e[T].id);return e[0].parent=null,t.blocks._addScript(e[0].id),runtime.requestBlocksUpdate(),vm.refreshWorkspace(),M?r:void 0}vm.on("PROJECT_CHANGED",ON_PROJECT_CHANGED);const cryptoRandom=(e,t)=>crypto.getRandomValues(new Uint8Array(1))[0]/255*(e-t)+t;class NicheToolbox{constructor(){this.RESERVED_NAMES=["_mouse_","_stage_","_edge_","_myself_","_random_"],this.DEFAULT_CATEGORYS=["motion","looks","sound","events","sensing","operators","variables","myBlocks"],this.PU_SEND_MENU=["start","end"],this.LAYER_TYPES='["backdrop", "video", "pen", "sprite"]',function(){var _0x319f41=_0x39b7;function _0x39b7(e,t){var M=_0x1014();return(_0x39b7=function(e,t){return M[e-=295]})(e,t)}function _0x1014(){var _0x1a7a35=["5111996tLmxub","1249FFuKyO","1978IqbbSd","6399coVOVY","runtime","36513147tcIYMv","2770QcbBHr","4226184ZCmoYg","56AWrHSS","getPrimitives","ext_scratch3_motion","1735195CoynVD","12TuUzZH","J05pY2hlLVRvb2xib3ggbXVzdCBiZSBydW4gdW5zYW5kYm94ZWRcbkFsc28gaWYgeW91IGFyZSBvbiBQTSBwbGVhc2UgdXNlIFRXLiBodHRwczovL3R1cmJvd2FycC5vcmcvZWRpdG9yJw==","649306AxaDMi",eval(atob("J21vdGlvbl9tb3ZlYmFja3N0ZXBzJw=="))];return _0x1014=function(){return _0x1a7a35},_0x1014()}!function(e,t){for(var M=_0x39b7,r=_0x1014();;)try{if(721474==parseInt(M(300))/1*(parseInt(M(301))/2)+-parseInt(M(306))/3+-parseInt(M(299))/4+parseInt(M(310))/5*(-parseInt(M(295))/6)+parseInt(M(297))/7*(-parseInt(M(307))/8)+-parseInt(M(302))/9*(-parseInt(M(305))/10)+parseInt(M(304))/11)break;r.push(r.shift())}catch(e){r.push(r.shift())}}(),vm[_0x319f41(303)][_0x319f41(309)][_0x319f41(308)]().hasOwnProperty(_0x319f41(298))&&throwwww(eval(atob(_0x319f41(296))))}()}getInfo(){return{id:"0znzwNicheToolbox",color1:"#ed6300",color2:"#d65900",color3:"#c65200",name:"The Niche Toolbox",menuIconURI:menuIconURI,blocks:[{text:"Open Warnings / Update Logs",blockType:BlockType.BUTTON,func:"openWarningsPage",hideFromPalette:!0},{opcode:"NT_is_BuiltInExt_or_ReservedName",text:"is [STR] a [IS]",blockType:BlockType.BOOLEAN,arguments:{STR:{type:ArgumentType.STRING,defaultValue:"motion"},IS:{type:ArgumentType.STRING,defaultValue:"base scratch category",menu:"NT_SIS"}}},{opcode:"cAxy_getColorAt",text:"get [attr] of color at x: [x] y: [y] with radius [rad]",disableMonitor:!0,blockType:BlockType.REPORTER,arguments:{attr:{type:ArgumentType.STRING,menu:"cAxy_modes"},x:{type:ArgumentType.NUMBER,defaultValue:0},y:{type:ArgumentType.NUMBER,defaultValue:0},rad:{type:ArgumentType.NUMBER,defaultValue:1}}},{opcode:"stJS_soundToDataUrl",blockType:BlockType.REPORTER,text:"convert sound [SOUND] to data URL",arguments:{SOUND:{type:ArgumentType.STRING,menu:"soundsMenu"}}},{opcode:"sUp_deleteCostume",blockType:BlockType.COMMAND,text:"delete costume [COSNAME] in [SPRITE]",arguments:{COSNAME:{type:ArgumentType.STRING,defaultValue:"costume1"},SPRITE:{type:ArgumentType.STRING,defaultValue:"Sprite1"}}},{opcode:"sUp_deleteSound",blockType:BlockType.COMMAND,text:"delete sound [SNDNAME] in [SPRITE]",arguments:{SNDNAME:{type:ArgumentType.STRING,defaultValue:"pop"},SPRITE:{type:ArgumentType.STRING,defaultValue:"Sprite1"}}},{hideFromPalette:!0,opcode:"sUp_deleteSpriteNoConfirm",blockType:BlockType.COMMAND,text:"Delete sprite [SPRITE] | No Confirmation",arguments:{SPRITE:{type:ArgumentType.STRING,defaultValue:"Sprite1"}}},{opcode:"PU_addPadding",blockType:BlockType.REPORTER,text:"add padding to [TEXT] with character [CHAR] to length [LEN] at [SEND]",arguments:{TEXT:{defaultValue:"aGk",type:ArgumentType.STRING},CHAR:{defaultValue:"=",type:ArgumentType.STRING},LEN:{defaultValue:4,type:ArgumentType.NUMBER},SEND:{defaultValue:"end",type:ArgumentType.STRING,menu:"PU_SEND"}}},{opcode:"NT_layerOrder",blockType:BlockType.COMMAND,text:"set layer ordering to [LAYER_ORDER]",arguments:{LAYER_ORDER:{defaultValue:this.LAYER_TYPES,type:ArgumentType.STRING}}},{opcode:"NT_unclampedFPS",blockType:BlockType.COMMAND,text:"set FPS to [FPS] (unclamped)",arguments:{FPS:{defaultValue:"300",type:ArgumentType.NUMBER}}},{opcode:"SGR_isPlayerOnly",blockType:BlockType.BOOLEAN,text:"user is not in the editor?"},{opcode:"SGR_isFullscreen",blockType:BlockType.BOOLEAN,text:"is fullscreen?"},{opcode:"SGR_isEmbedded",blockType:BlockType.BOOLEAN,text:"is embedded?"},{opcode:"SGR_hasEverEnteredEditor",blockType:BlockType.BOOLEAN,text:"has the user ever opened the editor?"},{opcode:"SP_isPackaged",blockType:BlockType.BOOLEAN,text:"is packaged?"},{opcode:"NT_projectEdited",blockType:BlockType.BOOLEAN,text:"project has been edited?"},{blockType:BlockType.COMMAND,opcode:"ISP_print_",text:"attempt to print image from url: [URI]",arguments:{URI:{type:ArgumentType.STRING,defaultValue:""}}},{opcode:"DCS_spriteToDataURL",blockType:BlockType.REPORTER,text:"export sprite [SPRITE] as dataURL",arguments:{SPRITE:{type:ArgumentType.STRING,defaultValue:"Sprite1"}}},{opcode:"NT_projectToDataURL",blockType:BlockType.REPORTER,text:"export project (dataURL) and compress ids [COMPRESS]",arguments:{COMPRESS:{type:ArgumentType.BOOLEAN}}},{opcode:"NT_runInProject",blockType:BlockType.CONDITIONAL,text:["load project from [URL] and run in sprite [SPRITE]","delete script when finished [DEL]"],arguments:{URL:{type:ArgumentType.STRING,defaultValue:""},SPRITE:{menu:"NT_runIPsprite"},DEL:{menu:"NT_YN",defaultValue:"no"}},branchCount:1},{opcode:"NT_crashPage",text:'crash page with "error": [MESSAGE]',blockType:BlockType.COMMAND,arguments:{MESSAGE:{type:ArgumentType.STRING,defaultValue:"Wtf???"}}},{opcode:"NT_cryptographicRandom",text:"(crypto) pick random [L] to [M]",blockType:BlockType.REPORTER,arguments:{L:{type:ArgumentType.NUMBER,defaultValue:1},M:{type:ArgumentType.NUMBER,defaultValue:10}}},{opcode:"NT_cryptographicValues",text:"random numbers (1-255) count: [C]",blockType:BlockType.REPORTER,arguments:{C:{type:ArgumentType.NUMBER,defaultValue:1}},allowDropAnywhere:!0}],menus:{soundsMenu:{acceptReporters:!0,items:"_getSounds"},NT_SIS:{acceptReporters:!0,items:["base scratch category","reserved sprite name"]},NT_runIPsprite:{acceptReporters:!0,acceptText:!0,items:[{text:"Stage",value:"_stage_"},{text:"first sprite",value:"_myself_"},{text:"last sprite",value:"last sprite"}]},NT_YN:{acceptReporters:!0,acceptText:!0,items:[{text:"yes",value:"true"},{text:"no",value:"false"}]},cAxy_modes:{acceptReporters:!0,items:["hex","rgb array","red","green","blue","alpha","pixels object"]},PU_SEND:{acceptReporters:!0,items:this.PU_SEND_MENU}}}}openWarningsPage(){window.open("https://load-ing.pages.dev/NicheToolbox/warnings.txt","_blank")}_hasOwn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}_GetCanvasWxH(){let e=renderer.canvas;return{width:e.width,height:e.height}}_ScratchXYtoCanvasXY(e,t){let M=this._GetCanvasWxH(),r=[M.width/renderer._nativeSize[0],M.height/renderer._nativeSize[1]];return{x:e*r[0]+M.width/2,y:t*-r[1]+M.height/2}}_isJSON(e){try{return JSON.parse(e)}catch{return!1}}_isArray(e){return"object"==typeof e&&!!this._hasOwn(e,"length")}hexify(e){return e.toString(16).padStart(2,"0")}_getSounds(){const e=runtime.getEditingTarget().sprite.sounds.map(e=>e.name);return e.length>0?e:[{text:"",value:""}]}_getSoundIndex(e,t){const M=t.target.sprite.sounds;return M.indexOf(M.filter(t=>t.name==e)[0])}_rgbaToHex(e,t,M,r){return`#${e=this.hexify(e)}${t=this.hexify(t)}${M=this.hexify(M)}${r=""==(r=r??"")?r:this.hexify(r)}`}_getSGredux(){return window?.ReduxStore?.getState?.()?.scratchGui}blobToBase64(e){const t=new FileReader;return t.readAsDataURL(e),new Promise(e=>{t.onloadend=()=>{e(t.result)}})}_loadProject(e){Scratch.fetch(e).then(e=>e.arrayBuffer()).then(e=>vm.loadProject(e))}NT_is_BuiltInExt_or_ReservedName(e){let t=Cast.toString(e.STR);switch(e.IS){case"base scratch category":return this.DEFAULT_CATEGORYS.includes(t);case"reserved sprite name":return this.RESERVED_NAMES.includes(t)}}NT_layerOrder(e){let t=Cast.toString(e.LAYER_ORDER);return this._isJSON(t)?(t=JSON.parse(t),this._isArray(t)?t.includes("backdrop")?t.includes("video")?t.includes("pen")?t.includes("sprite")?(CustomLayers=t,void updateLayerOrder()):(console.warn("Invalid Layer JSON: Missing Sprite Layer."),""):(console.warn("Invalid Layer JSON: Missing Pen Layer."),""):(console.warn("Invalid Layer JSON: Missing Video Layer."),""):(console.warn("Invalid Layer JSON: Missing Backdrop Layer."),""):(console.warn("Invalid Layer JSON: Must be an Array."),"")):(console.warn("Invalid Layer JSON: Must be JSON."),"")}NT_projectEdited(){return PROJECT_CHANGED}NT_unclampedFPS(e){runtime.frameLoop.framerate=Cast.toNumber(e.FPS),runtime.frameLoop._restart()}async NT_projectToDataURL(e){e.COMPRESS=Cast.toBoolean(e.COMPRESS);const t=vm.toJSON;vm.toJSON=function(e,M,...r){return M||={},M.allowOptimization=r.COMPRESS,t.call(this,e,M,...r)};let M="";try{M=await vm.saveProjectSb3(),M=await new Promise((e,t)=>{const r=new FileReader;r.onload=t=>e(r.result),r.onerror=e=>t(r.error),r.onabort=e=>t(new Error("Read aborted")),r.readAsDataURL(M)})}catch(e){console.error("Failed to save project",e)}return vm.toJSON=t,String(M)}NT_runInProject(e,t,M){const{target:r,thread:T}=t,{blocks:N}=r,u=Cast.toString(e.URL),s=Cast.toBoolean(e.DEL),a=cloneStack(N.getBranch(T.peekStack()),r);runtime.once("PROJECT_LOADED",()=>setTimeout(()=>{const t=a?.[0]?.id;if(!t)return;let M;switch(e.SPRITE){case"_stage_":M=runtime._stageTarget;break;case"_myself_":M=runtime.targets?.[1];break;case"last sprite":M=runtime.targets[runtime.targets.length-1];break;default:M=runtime.targets.find(t=>t.sprite.name===e.SPRITE)}M||(M=runtime._stageTarget),stackToTarget(a,M);const r=runtime._pushThread(t,M,{stackClick:!0});if(runtime.compilerOptions.enabled&&r.tryCompile(),s){function T(){if(!runtime.isActiveThread(r))return runtime.emit(Runtime.BLOCK_GLOW_OFF,{id:t}),M.blocks._deleteScript(t),runtime.requestBlocksUpdate(),void vm.refreshWorkspace();runtime.once("AFTER_EXECUTE",T)}runtime.once("AFTER_EXECUTE",T)}},50)),this._loadProject(u)}NT_crashPage({MESSAGE:e,FUCK_VM:t}){e=Cast.toString(e)||"???";Object.prototype.toString;throw Object.prototype.toString=function(){throw new Error(e)},vm.editingTarget={},vm.emitTargetsUpdate(),setTimeout(function(){document.querySelector("p[class^=crash-message_error-message]").textContent=e,Object.prototype.toString},100),new Error(e)}NT_cryptographicRandom({L:e,M:t}){return cryptoRandom(Cast.toNumber(t),Cast.toNumber(e))}NT_cryptographicValues({C:e}){return e=Array.from(crypto.getRandomValues(new Uint8Array(Math.max(1,Cast.toString(e))))),Scratch.extensions.isUSB||Scratch.extensions.isNitroBolt?e:JSON.stringify(e)}SGR_isEmbedded(){return this._getSGredux()?.mode?.isEmbedded??!1}SGR_isFullscreen(){return this._getSGredux()?.mode?.isFullScren??!1}SGR_isPlayerOnly(){return this._getSGredux()?.mode?.isPlayerOnly??!1}SGR_hasEverEnteredEditor(){return this._getSGredux()?.mode?.hasEverEnteredEditor??!1}SP_isPackaged(){return!window.ReduxStore?.getState&&!!window.scaffolding?.vm}sUp_deleteSpriteNoConfirm({SPRITE:e}){const t=runtime.getSpriteTargetByName(e);t&&!t.isStage&&vm.deleteSprite(t.id)}sUp_deleteCostume({SPRITE:e,COSNAME:t},M){let r="Stage"==(e=Cast.toString(e))?runtime.getTargetForStage():runtime.getSpriteTargetByName(e);r&&!this.RESERVED_NAMES.includes(e.toLowerCase())&&r.deleteCostume(r.getCostumeIndexByName(t))}sUp_deleteSound({SPRITE:e,SNDNAME:t},M){let r="Stage"==(e=Cast.toString(e))?runtime.getTargetForStage():runtime.getSpriteTargetByName(e);r&&!this.RESERVED_NAMES.includes(e.toLowerCase())&&r.deleteSound(this._getSoundIndex(t,M))}cAxy_getColorAt(e){let t=Cast.toNumber(e.x),M=Cast.toNumber(e.y),r=Cast.toString(e.attr),T=this._ScratchXYtoCanvasXY(t,M);t=T.x,M=T.y;let N=Cast.toNumber(e.rad||1);N<1&&.5!=N&&(N=1),.5==N&&(r="pixels object");let u=renderer.extractColor(t,M,N);const s=u.color;let a=s.r,n=s.g,o=s.b,c=s.a,L=[a,n,o];switch(r){case"hex":return this._rgbaToHex(a,n,o);case"rgb array":return JSON.stringify(L);case"red":return a;case"green":return n;case"blue":return o;case"alpha":return c;case"pixels object":return JSON.stringify(u.data);default:return NaN}}stJS_soundToDataUrl(e,t){const M=this._getSoundIndex(e.SOUND,t);if(M<0)return"";return t.target.sprite.sounds[M].asset.encodeDataURI()}PU_addPadding({TEXT:e,CHAR:t,LEN:M,SEND:r}){switch(e=Cast.toString(e),t=Cast.toString(t),M=Cast.toNumber(M),r=Cast.toString(r),this.PU_SEND_MENU.includes(r)||(r="start"),r){case"start":e=e.padStart(M,t);break;case"end":e=e.padEnd(M,t)}return e}ISP_print_(e){let t=Cast.toString(e.URI);var M=document.createElement("iframe");M.srcdoc=`<html><head></head><body><<img src="${t}"></img><script>setTimeout(function(){window.print()}, 500);<\/script></body></html>`,null==M.parentNode&&document.body.appendChild(M),setTimeout(function(){M.remove()},750)}async DCS_spriteToDataURL(e){const t=Cast.toString(e.SPRITE),M=runtime.getSpriteTargetByName(t);if(!M)return"";const r=await vm.exportSprite(M.id);return await this.blobToBase64(r)}}Scratch.extensions.register(new NicheToolbox)})(Scratch);