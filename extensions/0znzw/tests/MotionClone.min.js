/**!
 * Motion Category Remake
 * @author 0znzw <meow@miyo.icu> (@link https://scratch.mit.edu/users/0znzw/)
 * @version 1.0
 * @license MIT AND LGPL-3.0
 * Do not remove this comment
 */
!function(t,e){if(!t.extensions.unsandboxed||!t.extensions.isUSB||!e)throw new Error('"Motion" must be ran unsandboxed!');const o="0znzwMotion",{BlockType:r,ArgumentType:a,vm:i}=t,{runtime:c}=i;let n=globalThis.ScratchBlocks;!n&&t.gui&&t.gui.getBlockly().then(t=>{n=t});class l extends i.runtime.ext_scratch3_motion.constructor{static getMonitorId(t){return`${t||i.editingTarget.id}_${o}_${this}`}static getColours(){const t=n?n.Colours.motion:{primary:"#4C97FF",secondary:"#4280D7",tertiary:"#3373CC",quaternary:"#3373CC"};return{color1:t.primary,color2:t.secondary,color3:t.tertiary,color4:t.quaternary}}constructor(){super(c);const t=this.getPrimitives();Object.entries(t).forEach(t=>this[t[0].slice(t[0].indexOf("_")+1)]=t[1]);for(const t of this._getDynamics(!1,!1))c.monitorBlockInfo[`${o}_${t.opcode}`]={[o]:!0,isSpriteSpecific:!0,getId:l.getMonitorId.bind(t.opcode)};const e=c.flyoutBlocks.__proto__.constructor,r=e.prototype.createBlock;e.prototype.createBlock=function(t,...e){if(this!==c.flyoutBlocks&&this!==c.monitorBlocks)return r.call(this,t,...e);const a=c.monitorBlockInfo[t.opcode]||{};return a.isSpriteSpecific&&a[o]&&(t.targetId=i.editingTarget.id,t.id=a.getId(t.targetId)),r.call(this,t,...e)},c.flyoutBlocks.createBlock=e.prototype.createBlock.bind(c.flyoutBlocks),c.monitorBlocks.createBlock=e.prototype.createBlock.bind(c.monitorBlocks);const a=e.prototype._addScript;e.prototype._addScript=function(t,...e){if(this!==c.flyoutBlocks&&this!==c.monitorBlocks)return a.call(this,t,...e);const r=c.monitorBlockInfo[t]||{};return r.isSpriteSpecific&&r[o]&&(t=r.getId(i.editingTarget.id)),a.call(this,t,...e)},c.flyoutBlocks._addScript=e.prototype._addScript.bind(c.flyoutBlocks),c.monitorBlocks._addScript=e.prototype._addScript.bind(c.monitorBlocks)}getInfo(){const t=i.editingTarget.isStage;return{id:o,name:"Motion",...l.getColours(),blocks:[{blockType:r.LABEL,text:"Stage selected: no motion blocks",hideFromPalette:!t},{blockType:r.COMMAND,opcode:"movesteps",text:"move [STEPS] steps",arguments:{STEPS:{type:a.NUMBER,defaultValue:10}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"turnright",text:"turn [ARROW] [DEGREES] degrees",arguments:{ARROW:{type:a.IMAGE,dataURI:"static/blocks-media/default/rotate-right.svg"},DEGREES:{type:a.NUMBER,defaultValue:15}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"turnleft",text:"turn [ARROW] [DEGREES] degrees",arguments:{ARROW:{type:a.IMAGE,dataURI:"static/blocks-media/default/rotate-left.svg"},DEGREES:{type:a.NUMBER,defaultValue:15}},hideFromPalette:t},"---",{blockType:r.COMMAND,opcode:"goto",text:"go to [TO]",arguments:{TO:{type:a.STRING,menu:"targetsGoto"}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"gotoxy",text:"go to x: [X] y: [Y]",arguments:{X:{type:a.NUMBER,defaultValue:0},Y:{type:a.NUMBER,defaultValue:0}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"changebyxy",text:"change by x: [X] y: [Y]",arguments:{X:{type:a.NUMBER,defaultValue:10},Y:{type:a.NUMBER,defaultValue:10}},hideFromPalette:t},"---",{blockType:r.COMMAND,opcode:"pointtowards",text:"point in direction [TOWARDS]",arguments:{TOWARDS:{type:a.STRING,menu:"targetsDir"}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"pointtowardsxy",text:"point towards x: [X] y: [Y]",arguments:{X:{type:a.NUMBER,defaultValue:0},Y:{type:a.NUMBER,defaultValue:0}},hideFromPalette:t},"---",{blockType:r.COMMAND,opcode:"changexby",text:"change x by [DX]",arguments:{DX:{type:a.NUMBER,defaultValue:i.editingTarget.x}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"setx",text:"set x to [X]",arguments:{X:{type:a.NUMBER,defaultValue:10}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"changeyby",text:"change y by [DY]",arguments:{DY:{type:a.NUMBER,defaultValue:10}},hideFromPalette:t},{blockType:r.COMMAND,opcode:"sety",text:"set y to [Y]",arguments:{Y:{type:a.NUMBER,defaultValue:i.editingTarget.y}},hideFromPalette:t},"---",{blockType:r.COMMAND,opcode:"setrotationstyle",text:"set rotation style [STYLE]",arguments:{STYLE:{type:a.STRING,menu:"rotationStyle"}},hideFromPalette:t},...this._getDynamics(t,!0)],menus:{targetsGoto:{acceptReporters:!0,items:"_getTargetsGoto"},targetsDir:{acceptReporters:!0,items:"_getTargetsDir"},rotationStyle:{acceptReporters:!1,items:["left-right","looking","don't rotate","all around"]}}}}_getBlock(t){return i.editingTarget.blocks.getBlock(t)||c.getTargetForStage().blocks.getBlock(t)}_getTargetsInternal(t){let e=[{text:"mouse-pointer",value:"_mouse_"},{text:"camera",value:"_camera_"},{text:"random direction",value:"_random_"}];return t&&(e=[{text:"random position",value:"_random_"},{text:"camera",value:"_camera_"},{text:"mouse-pointer",value:"_mouse_"}]),e.concat(i.runtime.targets.filter(t=>!t.isStage&&t.isOriginal&&t.id!==i.editingTarget.id).map(t=>({text:t.getName(),value:t.id})))}_getTargetsGoto(){return this._getTargetsInternal(!0)}_getTargetsDir(){return this._getTargetsInternal(!1)}_getDynamics(t,e){const a=[{blockType:r.REPORTER,opcode:"rotationstyle",text:"rotation style",hideFromPalette:!!e||t},"---",{blockType:r.REPORTER,opcode:"xposition",text:"x position",hideFromPalette:!!e||t},{blockType:r.REPORTER,opcode:"yposition",text:"y position",hideFromPalette:!!e||t},{blockType:r.REPORTER,opcode:"direction",text:"direction",hideFromPalette:!!e||t}];return e?a.flatMap(e=>{if("---"===e)return[e];const a=`<block type="${o}_${e.opcode}" id="${l.getMonitorId.call(e.opcode)}"></block>`;return[e,{blockType:r.XML,xml:a,hideFromPalette:t}]}):a}}t.extensions.register(new l)}(globalThis.Scratch,globalThis.Unsandboxed);