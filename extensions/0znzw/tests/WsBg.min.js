/**!
 * Workspace Background
 * @author 0znzw <meow@miyo.icu> (@link https://scratch.mit.edu/users/0znzw/)
 * @version 1.0
 * @license MIT AND LGPL-3.0
 * Do not remove this comment
 */
!function(t){if(!t.extensions.unsandboxed)throw new Error('"Workspace Background" needs to be ran unsandboxed.');const{vm:e,BlockType:o}=t,{runtime:n}=e,r=function(t){return t.replace(/[<>&'"]/g,t=>{switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})},a=e.runtime._convertButtonForScratchBlocks;e.runtime._convertButtonForScratchBlocks=function(...t){const[e]=t,o=a.apply(this,t);return e.cssClass&&(o.xml=o.xml.replace("text",`web-class="${r(e.cssClass)}" text`)),"string"==typeof e.extraDom&&(o.xml=o.xml.replace("text",`extra-dom="${r(e.extraDom)}" text`)),o},localStorage["0zWsBg"]??='{"url":"https://search.bus-hit.me/image_proxy?url=https%3A%2F%2Fstaticg.sportskeeda.com%2Feditor%2F2024%2F07%2F8abf1-17207740847695-1920.jpg&h=d2d00513a0bfd5141ae6ddba8814de29b3151a72dddc71ba39519c6a2694d03c","opacity":"1"}',t.gui&&t.gui.getBlockly().then(t=>{const o=t.WorkspaceSvg.prototype,n=o.render;o.imageUrl=void 0,o.imageOpacity="1",o.computedStyles=null,o.render=function(...t){const e=n.apply(this,t),o=this.cachedParentSvg_;return this.imageUrl?(o.style["background-image"]=`url("${this.imageUrl}")`,o.style["background-size"]="cover",o.style["background-repeat"]="no-repeat",o.style.opacity=String(this.imageOpacity)):!this.imageUrl&&o.style["background-image"]&&(delete o.style["background-image"],delete o.style["background-size"],delete o.style["background-repeat"],delete o.style.opacity),e};const r=e.refreshWorkspace;e.refreshWorkspace=function(...e){try{const e=t.getMainWorkspace(),o=JSON.parse(localStorage["0zWsBg"]);e.imageOpacity=String(o.opacity),e.imageUrl=o.url,e.render()}catch{}return r.apply(this,e)},e.refreshWorkspace();const a=new DOMParser,c=t.FlyoutButton.prototype.init;t.FlyoutButton.prototype.init=function(...t){const e=t[2].getAttribute("extra-dom");return this.extraDom=e&&a.parseFromString(`<svg xmlns="http://www.w3.org/2000/svg"><g>${e}</g></svg>`,"image/svg+xml").getElementsByTagNameNS("http://www.w3.org/2000/svg","g").item(0)||!1,c.apply(this,t)};const s=t.FlyoutButton.prototype.createDom;t.FlyoutButton.prototype.createDom=function(...t){const e=s.apply(this,t);return this.extraDom&&e.appendChild(this.extraDom),e}});const c=document.createElement("style");c.textContent="\n.a0znzwWsBackground-bgButton, .a0znzwWsBackground-opButton, .a0znzwWsBackground-bgButton rect.blocklyFlyoutButtonBackground, .a0znzwWsBackground-opButton rect.blocklyFlyoutButtonBackground {\n  width: 200px;\n}\n  ",document.head.appendChild(c);t.extensions.register(new class{getInfo(){return{id:"0znzwWsBackground",name:"Workspace Background",blocks:[{blockType:o.HAT,opcode:"temp",text:"Put this in the project to save.",isTerminal:!0},{blockType:o.LABEL,text:"Set BG:"},{blockType:o.BUTTON,func:"updateBG",text:"‭",cssClass:"a0znzwWsBackground-bgButton",extraDom:'\n            <foreignObject x="30" y="10" width="200" height="20">\n              <input type="url" width="50" height="20" xmlns="http://www.w3.org/1999/xhtml" />\n            </foreignObject>\n          '},{blockType:o.LABEL,text:"Set Opacity:"},{blockType:o.BUTTON,func:"updateOpacity",text:"‭",cssClass:"a0znzwWsBackground-opButton",extraDom:'\n            <foreignObject x="30" y="10" width="200" height="20">\n              <input type="number" width="50" height="20" xmlns="http://www.w3.org/1999/xhtml" min="0" max="100" />\n            </foreignObject>\n          '}]}}updateBG(){const t=document.querySelector("g.a0znzwWsBackground-bgButton input");t||console.warn("Unable to find input"),function(t){const e=JSON.parse(localStorage["0zWsBg"]);e.url=t,localStorage["0zWsBg"]=JSON.stringify(e)}(t.value),e.refreshWorkspace()}updateOpacity(){const t=document.querySelector("g.a0znzwWsBackground-opButton input");t||console.warn("Unable to find input"),function(t){const e=JSON.parse(localStorage["0zWsBg"]);e.opacity=t,localStorage["0zWsBg"]=JSON.stringify(e)}(Math.max(Math.min(Number(t.value),100),0)/100||0),e.refreshWorkspace()}temp(){}})}(Scratch);