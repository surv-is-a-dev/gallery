/**!
 * Break + Continue test
 * @author 0znzw <meow@miyo.icu> (@link https://scratch.mit.edu/users/0znzw/)
 * @version 1.2
 * @license MIT AND LGPL-3.0
 * Do not remove this comment
 */
!function(e){if(!e.extensions.unsandboxed)throw new Error('"Loop test" must be ran unsandboxed.');const{BlockType:o,ArgumentType:t,vm:n}=e;if(n.exports.these_broke_before_and_will_break_again)throw window.scaffolding||alert("GarboMuffins an ass so this doesnt work anymore lmfao."),"stub is not supported.";if(n.exports.i_will_not_ask_for_help_when_these_break){const e=n.exports.i_will_not_ask_for_help_when_these_break();if(e.IntermediateStackedBlock)window.scaffolding||alert("TW (old) format compiler is required, compiler will not work.");else{const{JSGenerator:o,ScriptTreeGenerator:t}=e,n=o.prototype,r=t.prototype,a=n.descendStackedBlock,s=r.descendStackedBlock;n.descendStackedBlock=function(...e){if(console.log(e),"0znzwBreakTest.break"===e[0].kind){if(!this.frames.find(e=>e.isLoop)?.isLoop)return null;this.source+="\nbreak;\n"}else{if("0znzwBreakTest.continue"!==e[0].kind)return a.apply(this,e);if(!this.frames.find(e=>e.isLoop)?.isLoop)return null;this.source+="\ncontinue;\n"}},r.descendStackedBlock=function(...e){return"0znzwBreakTest_break"===e[0].opcode?{kind:"0znzwBreakTest.break"}:"0znzwBreakTest_continue"===e[0].opcode?{kind:"0znzwBreakTest.continue"}:s.apply(this,e)}}}else n.exports.JSGenerator&&(window.scaffolding||alert("TW (old) format compiler is required, compiler will not work."));e.extensions.register(new class{getInfo(){return{id:"0znzwBreakTest",name:"Break + Continue!!",blocks:[{opcode:"break",blockType:o.COMMAND,text:"break (my legs)",isTerminal:!0},{opcode:"continue",blockType:o.COMMAND,text:"continue (your meds)",isTerminal:!0}]}}_getLoopFrame(e){const o=e.stackFrames;let t=null,n=-1;for(let e=o.length-1;e>=0&&!(e<0);e--)if(o[e].isLoop){t=o[e].op.id,n=e;break}return!!t&&[t,n]}break(e,o){const t=o.thread,n=t.peekStackFrame();if(!n._breakData){let e=!1;if(!(e=this._getLoopFrame(t)))return console.warn("Not in a loop!");const o=e[0],r=t.blockContainer.getBlock(o).next;n._breakData={loopFrameBlock:o,afterLoop:r}}const{loopFrameBlock:r,afterLoop:a}=n._breakData;for(;t.stack.at(-1)!==r;)t.popStack();t.popStack(),a&&t.pushStack(a)}continue(e,o){const t=o.thread,n=(t.blockContainer,t.peekStackFrame());if(!n._continueData){let e=!1;if(!(e=this._getLoopFrame(t)))return console.warn("Not in a loop!");n._continueData=e[0]}for(;t.stack[0]&&t.stack.at(-1)!==n._continueData;)t.popStack();t.status=t.constructor.STATUS_YIELD}})}(Scratch);