/**!
 * Post-Message
 * @author 0znzw <meow@miyo.lol> (@link https://scratch.mit.edu/users/0znzw/)
 * @version 1.0
 * @license MIT AND LGPL-3.0
 * Do not remove this comment
 */
!function(e){if(!e.extensions.unsandboxed)throw new Error('"Post-Message" must be ran unsandboxed.');const{Cast:t,BlockType:s,ArgumentType:o,vm:a}=e,{runtime:r}=a;window.addEventListener("message",(e=>{(e=>{const t=[];for(const s of r.targets)Object.values(s.blocks._blocks).filter((t=>t.opcode===e)).forEach((e=>{t.push(r._pushThread(e.id,s,{stackClick:!0}))}));return t})("0znzwPostMessage_recv").forEach((t=>t.postMessageEvent=e))}));e.extensions.register(new class{getInfo(){return{id:"0znzwPostMessage",name:"Post-Message",blocks:[{opcode:"post",blockType:s.COMMAND,text:"post message [MSG] to [DOMAIN] on [PAR]",arguments:{MSG:{type:o.STRING,defaultValue:"Hello, World!~"},DOMAIN:{type:o.STRING,defaultValue:"https://turbowarp.org/"},PAR:{type:o.STRING,menu:"target"}}},{opcode:"recv",blockType:s.HAT,text:"when posted message recivied",isEdgeActivated:!1},"---",{opcode:"data",blockType:s.REPORTER,text:"recevied data",disableMonitor:!0},{opcode:"origin",blockType:s.REPORTER,text:"data origin",disableMonitor:!0}],menus:{target:{acceptReporters:!0,items:["self","parent"]}}}}post({MSG:e,DOMAIN:s,PAR:o}){if(e=t.toString(e),s=t.toString(s),o="parent"===t.toString(o),"*"!==s&&!(e=>{try{return new URL(e)}catch{return!1}})(s))return!1;o?window.parent&&window.parent.postMessage(e,s):window.postMessage(e,s)}recv(e,{thread:t}){return t.postMessageEvent?(t.postMessageOrigin=t.postMessageEvent.origin??"*",t.postMessageData=t.postMessageEvent.data??"",delete t.postMessageEvent,!0):(t.status=4,!1)}origin(e,{thread:t}){return t.postMessageOrigin||"*"}data(e,{thread:t}){return t.postMessageData||""}})}(Scratch);